# 代码运行说明

1. 命令

进入文件夹：

```shell script
cd /home/ccq/Research/RumorInfoGraph/Main
```

运行程序：

```shell script
nohup python main\(pretrain\).py --gpu 0 &
nohup python main\(semisup\).py --gpu 3 &
```

# 实验记录

1. Weibo

 - 实验结果
 
 半监督实验：

| id | mode | use contrast | sep encoder | label limit | unlabel limit | clean | unlabel num | we size | dim | batch size | unsup bs ratio | split | test acc | max acc |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1 | sup | None | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **8** | 0 | 6:2:2 | 0.936±0.010 | 0.955 |
| 2 | sup | None | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **12** | 0 | 6:2:2 | 0.938±0.007 | 0.950 |
| 3 | sup | None | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **16** | 0 | 6:2:2 | 0.933±0.005 | 0.940 |
| |
| 4 | sup | **label** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **8** | 0 | 6:2:2 | 0.936±0.011 | 0.945 |
| 5 | sup | **label** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **12** | 0 | 6:2:2 | 0.938±0.008 | 0.953 |
| 6 | sup | **label** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **16** | 0 | 6:2:2 | 0.939±0.006 | 0.950 |
| |
| 7 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **8** | 1 | 6:2:2 | **0.944±0.013** | 0.979 |
| 8 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **12** | 1| 6:2:2 | **0.941±0.012** | 0.970 |
| 9 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **16** | 1 | 6:2:2 | 0.938±0.006 | 0.951 |
| 10 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | **95260** | 100 | 80 | **8** | 1 | 6:2:2 | **0.945±0.005** | 0.952 |
| |
| 11 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **8** | **2** | 6:2:2 | **0.943±0.006** | 0.954 |
| 12 | **semi-sup** | **label,unlabel** | True | 600 | no limite | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **12** | **2** | 6:2:2 | **0.940±0.007** | 0.957 |
| 13 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **16** | **2** | 6:2:2 | 0.938±0.006 | 0.947 |
| 14 | **semi-sup** | **label,unlabel** | True | 600 | no limit | 清理“转发微博”，清理“回复@” | **95260** | 100 | 80 | **8** | **2** | 6:2:2 | **0.944±0.004** | 0.950 |
| |
| 15 | **semi-sup** | **label,unlabel** | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **8** | **2** | 6:2:2 | **0.945±0.008** | 0.960 |
| 16 | **semi-sup** | **label,unlabel** | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **12** | **2** | 6:2:2 | **0.940±0.006** | 0.949 |
| 17 | **semi-sup** | **label,unlabel** | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | **16** | **2** | 6:2:2 | 0.937±0.005 | 0.946 |
| 18 | **semi-sup** | **label,unlabel** | **False** | 600 | no limit | 清理“转发微博”，清理“回复@” | **95260** | 100 | 80 | **8** | **2** | 6:2:2 | **0.942±0.008** | 0.958 |

word embedding参数:

| id | algo | word embedding size |train w2v data | window | min count | epoch | vacab size |
| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1-18 | skip-gram | 100 | all label + 60198 unlabel | 5 | 5 | 10 | 10828 |

---

小样本实验：

| id | mode | sep encoder | label limit | unlabel limit | clean | unlabel num | we size | dim | batch size | k | test acc | max acc |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1 | pretrain+finetuning | False | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | 8 | **10** | 0.808±0.061 | 0.884 |
| 2 | - | - | - | - | - | - | - | - | - | **20** | 0.818±0.057 | 0.894 |
| 3 | - | - | - | - | - | - | - | - | - | **40** | 0.826±0.063 | 0.908 |
| 4 | - | - | - | - | - | - | - | - | - | **80** | 0.842±0.045 | 0.906 |
| 5 | - | - | - | - | - | - | - | - | - | **100** | 0.844±0.047 | 0.907 |
| 6 | - | - | - | - | - | - | - | - | - | **200** | 0.847±0.045 | 0.905 |
| 7 | - | - | - | - | - | - | - | - | - | **400** | 0.859±0.032 | 0.895 |
| 8 | - | - | - | - | - | - | - | - | - | **∞** | 0.876±0.033 | 0.912 |
| |
| 9 | semi-sup | False | 600 | no limit | 清理“转发微博”，清理“回复@” | 60198 | 100 | 80 | 8 | **10** | 0.641±0.045 | 0.719 |
| 10 | - | - | - | - | - | - | - | - | - | **20** | 0.698±0.037 | 0.747 |
| 11 | - | - | - | - | - | - | - | - | - | **40** | 0.762±0.022 | 0.808 |
| 12 | - | - | - | - | - | - | - | - | - | **80** | 0.797±0.019 | 0.822 |
| 13 | - | - | - | - | - | - | - | - | - | **100** | 0.810±0.015 | 0.838 |
| 14 | - | - | - | - | - | - | - | - | - | **200** | 0.824±0.017 | 0.840 |
| 15 | - | - | - | - | - | - | - | - | - | **400** | 0.863±0.003 | 0.867 | 
| 16 | - | - | - | - | - | - | - | - | - | **∞** | 0.942±0.008 | 0.958 |

word embedding参数:

| id | algo | word embedding size |train w2v data | window | min count | epoch | vacab size |
| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1-16 | skip-gram | 100 | all label + 60198 unlabel | 5 | 5 | 10 | 10828 |

2. weibo(self)

| id | mode | use contrast | sep encoder | label limit | unlabel limit | clean | unlabel num | we size | dim | batch size | unsup bs ratio | split | test acc | max acc |
| :----:| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1 | sup | None | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **8** | 0 | 6:2:2 | 0.841±0.020 | 0.883 |
| 2 | sup | None | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **12** | 0 | 6:2:2 | 0.853±0.020 | 0.891 |
| 3 | sup | None | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **16** | 0 | 6:2:2 | 0.831±0.030 | 0.893 |
| |
| 4 | sup | **label** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **8** | 0 | 6:2:2 | 
| 5 | sup | **label** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **12** | 0 | 6:2:2 | 
| 6 | sup | **label** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **16** | 0 | 6:2:2 | 
| |
| 7 | sup | **label** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **8** | 0 | 6:2:2 | 
| 8 | sup | **label** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **12** | 0 | 6:2:2 | 
| 9 | sup | **label** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 0 | 100 | 80 | **16** | 0 | 6:2:2 | 
| |
| 10 | **semi-sup** | **label,unlabel** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **8** | 1 | 6:2:2 | 
| 11 | **semi-sup** | **label,unlabel** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **12** | 1| 6:2:2 | 
| 12 | **semi-sup** | **label,unlabel** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **16** | 1 | 6:2:2 | 
| |
| 13 | **semi-sup** | **label,unlabel** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **8** | **2** | 6:2:2 | 0.833±0.022 | 0.863 |
| 14 | **semi-sup** | **label,unlabel** | True | no limit | no limite | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **12** | **2** | 6:2:2 | 0.823±0.015 | 0.843 |
| 15 | **semi-sup** | **label,unlabel** | True | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **16** | **2** | 6:2:2 | 0.823±0.015 | 0.875 |
| |
| 16 | **semi-sup** | **label,unlabel** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **8** | **2** | 6:2:2 | 0.834±0.031 | 0.875 |
| 17 | **semi-sup** | **label,unlabel** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **12** | **2** | 6:2:2 | 0.823±0.031 | 0.863 |
| 18 | **semi-sup** | **label,unlabel** | **False** | no limit | no limit | 清理“转发微博”，清理“回复@” | 95260 | 100 | 80 | **16** | **2** | 6:2:2 | 0.843±0.018 | 0.867 |

word embedding参数:

| id | algo | word embedding size |train w2v data | window | min count | epoch | vacab size |
| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| 1-18 | skip-gram | 100 | all label + 20000 unlabel | 5 | 5 | 10 | 7364 |

# 备注

1. 数据集id错误的修改

把微博数据集```3495745049431351.json```的源帖子```mid```改成了```3495745049431350```。

2. 微博标注数据集

处理后的微博标注数据集一般满足评论的id大于其父节点的id，但是有以下几个不满足帖子不满足：

| filename | cid | pid |
| :----:| :----: | :----: |
| 3521098215849074.json | 6429 | 6430 |
| 3567091888659283.json | 1169 | 1172 |
| 3515863422717161.json | 12325 | 12328 |
| 3515863422717161.json | 12621 | 12624 |
| 3512941028164269.json | 4781 | 4782 |

cid: comment id

pid: parent id

